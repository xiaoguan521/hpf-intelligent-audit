{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.18", "generated_at": "2026-01-19T05:14:13.993036Z", "invocation_id": "d44bf012-f028-43ab-b22d-24a837f01a96", "invocation_started_at": "2026-01-19T05:14:10.979551Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:12.705496Z", "completed_at": "2026-01-19T05:14:12.718914Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:12.719360Z", "completed_at": "2026-01-19T05:14:12.816974Z"}], "thread_id": "Thread-1", "execution_time": 0.11385226249694824, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.src_gr_dk_hkmx", "compiled": true, "compiled_code": "select * from \"warehouse\".\"main\".\"src_repayments\"", "relation_name": "\"warehouse\".\"analytics\".\"src_gr_dk_hkmx\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:12.825030Z", "completed_at": "2026-01-19T05:14:12.830402Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:12.830741Z", "completed_at": "2026-01-19T05:14:12.864288Z"}], "thread_id": "Thread-1", "execution_time": 0.040769100189208984, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.src_gr_dk_ht", "compiled": true, "compiled_code": "select * from \"warehouse\".\"main\".\"src_contracts\"", "relation_name": "\"warehouse\".\"analytics\".\"src_gr_dk_ht\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:12.868635Z", "completed_at": "2026-01-19T05:14:12.874241Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:12.874740Z", "completed_at": "2026-01-19T05:14:12.906758Z"}], "thread_id": "Thread-1", "execution_time": 0.03938603401184082, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.src_gr_jcxx", "compiled": true, "compiled_code": "select * from \"warehouse\".\"main\".\"src_customers\"", "relation_name": "\"warehouse\".\"analytics\".\"src_gr_jcxx\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:12.912047Z", "completed_at": "2026-01-19T05:14:12.917998Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:12.918610Z", "completed_at": "2026-01-19T05:14:13.217968Z"}], "thread_id": "Thread-1", "execution_time": 0.3080151081085205, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.stg_repayments", "compiled": true, "compiled_code": "with source as ( select * from \"warehouse\".\"analytics\".\"src_gr_dk_hkmx\" )\n\nselect\n    contract_no as contract_id,\n    cast(period as integer) as period_number,\n\n-- \u65e5\u671f\u8f6c\u6362\ncast(due_date as date) as due_date,\ncast(actual_date as date) as actual_repayment_date,\n\n-- \u72b6\u6001\u6620\u5c04\ncase\n    when status = '1' then 'normal'\n    when status = '2' then 'overdue'\n    else 'unknown'\nend as repayment_status,\n\n-- \u884d\u751f\u6307\u6807: \u662f\u5426\u5df2\u8fd8\u6e05 (\u5b9e\u8fd8\u65e5\u671f\u975e\u7a7a)\ncase\n    when actual_date is not null then true\n    else false\nend as is_paidoff\nfrom source", "relation_name": "\"warehouse\".\"analytics\".\"stg_repayments\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:13.222252Z", "completed_at": "2026-01-19T05:14:13.226358Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:13.226673Z", "completed_at": "2026-01-19T05:14:13.298084Z"}], "thread_id": "Thread-1", "execution_time": 0.0771629810333252, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.stg_contracts", "compiled": true, "compiled_code": "with source as ( select * from \"warehouse\".\"analytics\".\"src_gr_dk_ht\" )\n\nselect\n    -- 1. \u91cd\u547d\u540dID\u5217\n    contract_no as contract_id,\n    cust_id,\n\n-- 2. \u7c7b\u578b\u8f6c\u6362 (Decimal & Integer)\ncast(loan_amt as decimal(18, 2)) as loan_amount,\ncast(loan_period as integer) as loan_period_months,\n\n-- 3. \u65e5\u671f\u5904\u7406\ncast(loan_date as date) as loan_start_date,\n\n-- 4. \u72b6\u6001\u6620\u5c04 (\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91)\ncase\n    when status = '01' then 'active' -- \u6b63\u5e38\n    when status = '02' then 'overdue' -- \u903e\u671f\n    when status = '03' then 'closed' -- \u7ed3\u6e05\n    else 'unknown'\nend as loan_status\nfrom source\nwhere\n    loan_amt > 0 -- 5. \u8fc7\u6ee4\u6389\u91d1\u989d\u5f02\u5e38\u7684\u6570\u636e", "relation_name": "\"warehouse\".\"analytics\".\"stg_contracts\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:13.301091Z", "completed_at": "2026-01-19T05:14:13.303964Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:13.304242Z", "completed_at": "2026-01-19T05:14:13.413220Z"}], "thread_id": "Thread-1", "execution_time": 0.11316299438476562, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.stg_customers", "compiled": true, "compiled_code": "with source as ( select * from \"warehouse\".\"analytics\".\"src_gr_jcxx\" )\n\nselect\n    cust_id,\n    name as customer_name,\n    cast(age as integer) as age,\n    cast(income as decimal(18, 2)) as monthly_income,\n\n-- New Enhanced Features\noccupation, city_tier, credit_score,\n\n-- \u6027\u522b\u6620\u5c04\ncase\n    when gender = '1' then 'M'\n    when gender = '2' then 'F'\n    else 'U'\nend as gender\nfrom source", "relation_name": "\"warehouse\".\"analytics\".\"stg_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-19T05:14:13.417156Z", "completed_at": "2026-01-19T05:14:13.487715Z"}, {"name": "execute", "started_at": "2026-01-19T05:14:13.488186Z", "completed_at": "2026-01-19T05:14:13.984746Z"}], "thread_id": "Thread-1", "execution_time": 0.5692689418792725, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.hpf_analytics.fct_loan_features", "compiled": true, "compiled_code": "with contracts as (\n    select * from \"warehouse\".\"analytics\".\"stg_contracts\"\n),\n\ncustomers as (\n    select * from \"warehouse\".\"analytics\".\"stg_customers\"\n),\n\nrepayments as (\n    select * from \"warehouse\".\"analytics\".\"stg_repayments\"\n),\n\n-- \u2728 \u6838\u5fc3\u9b54\u6cd5\uff1a\u8ba1\u7b97\u8fd8\u6b3e\u8868\u73b0\u6307\u6807\nrepayment_metrics as (\n    select\n        contract_id,\n        count(*) as total_periods,\n        -- \u8ba1\u7b97\u903e\u671f\u6b21\u6570\n        sum(\n            case\n                when repayment_status = 'overdue' then 1\n                else 0\n            end\n        ) as overdue_count,\n        -- \u8ba1\u7b97\u662f\u5426\u53d1\u751f\u8fc7\u903e\u671f (0/1)\n        max(\n            case\n                when repayment_status = 'overdue' then 1\n                else 0\n            end\n        ) as has_overdue_history\n    from repayments\n    group by\n        contract_id\n)\n\n-- \ud83c\udfc1 \u6700\u7ec8\u7ec4\u88c5\uff1a\u5408\u540c + \u5ba2\u6237 + \u8fd8\u6b3e\u6307\u6807\nselect c.contract_id, c.loan_status, c.loan_amount, c.loan_period_months, c.loan_start_date, cust.age, cust.gender, cust.monthly_income,\n\n-- New Enhanced Features\ncust.occupation,\ncust.city_tier,\ncust.credit_score,\ncoalesce(rm.overdue_count, 0) as overdue_count,\ncoalesce(rm.total_periods, 0) as total_repayment_periods,\n\n-- Categorical Features for Better Model\ncase\n    when c.loan_amount / cust.monthly_income > 5 then 'high_risk'\n    when c.loan_amount / cust.monthly_income > 3 then 'medium_risk'\n    else 'low_risk'\nend as dti_category,\ncase\n    when cust.age < 25 then 'young'\n    when cust.age between 25 and 40  then 'prime'\n    when cust.age between 40 and 55  then 'mature'\n    else 'senior'\nend as age_group,\ncase\n    when cust.monthly_income < 5000 then 'low_income'\n    when cust.monthly_income < 10000 then 'middle_income'\n    else 'high_income'\nend as income_level,\ncase\n    when c.loan_period_months > 240 then 'ultra_long'\n    when c.loan_period_months > 120 then 'long_term'\n    else 'short_term'\nend as loan_duration_type,\n\n-- Target Label\ncase\n    when coalesce(rm.overdue_count, 0) > 0 then 1\n    else 0\nend as target_label, -- \u8fd9\u662f ML \u7684\u9884\u6d4b\u76ee\u6807\uff01\ncoalesce(rm.has_overdue_history, 0) as has_overdue_history_flag\nfrom\n    contracts c\n    -- \u5173\u8054\u5ba2\u6237\u8868\n    left join customers cust on c.cust_id = cust.cust_id\n    -- \u5173\u8054\u8fd8\u6b3e\u6307\u6807\u8868\n    left join repayment_metrics rm on c.contract_id = rm.contract_id", "relation_name": "\"warehouse\".\"analytics\".\"fct_loan_features\"", "batch_results": null}], "elapsed_time": 1.4993550777435303, "args": {"require_resource_names_without_spaces": true, "project_dir": "/Volumes/\u79fb\u52a8\u78c1\u76d8/test/hpf-platform/dbt_project", "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "invocation_command": "dbt run", "quiet": false, "select": [], "favor_state": false, "log_format": "default", "require_all_warnings_handled_by_warn_error": false, "log_level_file": "debug", "upload_to_artifacts_ingest_api": false, "profiles_dir": "/Volumes/\u79fb\u52a8\u78c1\u76d8/test/hpf-platform/dbt_project", "require_yaml_configuration_for_mf_time_spines": false, "log_path": "/Volumes/\u79fb\u52a8\u78c1\u76d8/test/hpf-platform/dbt_project/logs", "require_generic_test_arguments_property": true, "macro_debugging": false, "which": "run", "log_level": "info", "static_parser": true, "use_colors": true, "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "vars": {}, "require_nested_cumulative_type_params": false, "source_freshness_run_project_hooks": true, "exclude": [], "defer": false, "introspect": true, "state_modified_compare_vars": false, "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "strict_mode": false, "log_file_max_bytes": 10485760, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "write_json": true, "send_anonymous_usage_stats": true, "show_all_deprecations": false, "populate_cache": true, "print": true, "log_format_file": "debug", "cache_selected_only": false, "partial_parse": true, "use_colors_file": true, "use_fast_test_edges": false, "printer_width": 80, "indirect_selection": "eager", "validate_macro_args": false, "partial_parse_file_diff": true}}