version: '3.8'

services:
  ml-trainer:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: hpf-ml-trainer
    volumes:
      # æ•°æ®æŒä¹…åŒ–
      - ./data:/app/data
      # æ¨¡å‹è¾“å‡º
      - ./hpf_platform/ml/models:/app/hpf_platform/ml/models
    environment:
      - PYTHONUNBUFFERED=1
    command: >
      sh -c " echo 'ğŸš€ Starting ML Training Pipeline...' && python scripts/generate_mock_data.py && cd dbt_project && dbt deps && dbt run && cd .. && python hpf_platform/ml/train.py "
    # å¯é€‰ï¼šé™åˆ¶èµ„æº
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '4'
    #       memory: 8G
